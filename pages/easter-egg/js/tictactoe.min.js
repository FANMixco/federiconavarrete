const cells=document.querySelectorAll("[data-cell]"),message=document.getElementById("message");let currentPlayer="X",gameActive=!0,aiThinking=!1;function restartGame(){location.reload()}document.getElementById("footer").innerHTML+=`&nbsp;${(new Date).getFullYear()}`;const winningCombinations=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];function handleCellClick(e){const t=e.target;parseInt(t.getAttribute("data-cell"));""===t.textContent&&gameActive&&!aiThinking&&"O"!==currentPlayer&&(t.textContent=currentPlayer,checkWin(currentPlayer)?(message.classList.add("win-text"),highlightWinner(),message.textContent=`${currentPlayer} wins!`,gameActive=!1):isDraw()?(message.classList.add("win-text"),message.textContent="It's a draw!",gameActive=!1,handleDraw()):(currentPlayer="X"===currentPlayer?"O":"X",message.textContent=`${currentPlayer}'s turn`,"O"===currentPlayer&&(aiThinking=!0,setTimeout(makeMove,500))))}function makeMove(){"O"===currentPlayer&&(Math.random()<.75?makeOptimalMove():makeRandomMove(),aiThinking=!1,cells.forEach((e=>e.addEventListener("click",handleCellClick))))}function checkWin(e){return winningCombinations.some((t=>t.every((t=>cells[t].textContent===e))))}function isDraw(){return[...cells].every((e=>""!==e.textContent))&&!checkWin("X")&&!checkWin("O")}function highlightWinner(){winningCombinations.forEach((e=>{const[t,n,a]=e;cells[t].textContent===cells[n].textContent&&cells[n].textContent===cells[a].textContent&&""!==cells[t].textContent&&(cells[t].classList.add("winner"),cells[n].classList.add("winner"),cells[a].classList.add("winner"))}))}function handleDraw(){cells.forEach((e=>{e.classList.add("draw")})),document.querySelector(".board").classList.add("draw-board")}function makeRandomMove(){const e=[...cells].filter((e=>""===e.textContent));e[Math.floor(Math.random()*e.length)].textContent=currentPlayer,checkWin(currentPlayer)?(highlightWinner(),message.classList.add("win-text"),message.textContent=`${currentPlayer} wins!`,gameActive=!1):isDraw()?(message.classList.add("win-text"),message.textContent="It's a draw!",gameActive=!1,handleDraw()):(currentPlayer="X",message.textContent=`${currentPlayer}'s turn`)}function makeOptimalMove(){let e,t=-1/0;for(let n=0;n<cells.length;n++)if(""===cells[n].textContent){cells[n].textContent=currentPlayer;const a=minimax(cells,0,!1);cells[n].textContent="",a>t&&(t=a,e=n)}cells[e].textContent=currentPlayer,checkWin(currentPlayer)?(message.classList.add("win-text"),highlightWinner(),message.textContent=`${currentPlayer} wins!`,gameActive=!1):isDraw()?(message.classList.add("win-text"),message.textContent="It's a draw!",gameActive=!1,handleDraw()):(currentPlayer="X",message.textContent=`${currentPlayer}'s turn`),aiThinking=!1}function minimax(e,t,n){const a=checkResult();if(null!==a)return a;if(n){let n=-1/0;for(let a=0;a<e.length;a++)if(""===e[a].textContent){e[a].textContent="O";const l=minimax(e,t+1,!1);e[a].textContent="",n=Math.max(l,n)}return n}{let n=1/0;for(let a=0;a<e.length;a++)if(""===e[a].textContent){e[a].textContent="X";const l=minimax(e,t+1,!0);e[a].textContent="",n=Math.min(l,n)}return n}}function checkResult(){for(let e=0;e<winningCombinations.length;e++){const[t,n,a]=winningCombinations[e];if(cells[t].textContent===cells[n].textContent&&cells[n].textContent===cells[a].textContent&&""!==cells[t].textContent)return"O"===cells[t].textContent?1:-1}return isDraw()?0:null}function startGame(){cells.forEach((e=>{e.textContent="",e.classList.remove("winner"),e.addEventListener("click",handleCellClick)})),message.textContent=`${currentPlayer}'s turn`,gameActive=!0}startGame();